@{
    ViewData["Title"] = "Gestión de Productos";
}

<div class="d-flex justify-content-between align-items-center mb-4">
    <h1><i class="fas fa-box text-warning"></i> Gestión de Productos</h1>
    <span class="badge bg-warning text-dark fs-6">
        <i class="fas fa-key"></i> Requiere Permiso: products.manage
    </span>
</div>

<div class="protected-section">
    <h5><i class="fas fa-lock"></i> Autorización por Permisos</h5>
    <p class="mb-0">Esta página requiere el permiso específico <strong>"products.manage"</strong> otorgado a través del Claims Transformation Service.</p>
</div>

<div class="row mb-4">
    <div class="col-md-3">
        <div class="card bg-primary text-white">
            <div class="card-body text-center">
                <h4>1,247</h4>
                <p class="mb-0">Total Productos</p>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card bg-success text-white">
            <div class="card-body text-center">
                <h4>891</h4>
                <p class="mb-0">En Stock</p>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card bg-warning text-dark">
            <div class="card-body text-center">
                <h4>23</h4>
                <p class="mb-0">Stock Bajo</p>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card bg-danger text-white">
            <div class="card-body text-center">
                <h4>5</h4>
                <p class="mb-0">Agotados</p>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header bg-warning text-dark d-flex justify-content-between">
                <h5><i class="fas fa-list"></i> Lista de Productos</h5>
                <button class="btn btn-dark btn-sm">
                    <i class="fas fa-plus"></i> Nuevo Producto
                </button>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nombre</th>
                                <th>Categoría</th>
                                <th>Precio</th>
                                <th>Stock</th>
                                <th>Estado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>PRD001</td>
                                <td>Laptop Dell XPS 13</td>
                                <td>Electrónicos</td>
                                <td>$1,299.99</td>
                                <td>45</td>
                                <td><span class="badge bg-success">Activo</span></td>
                                <td>
                                    <button class="btn btn-sm btn-primary"><i class="fas fa-edit"></i></button>
                                    <button class="btn btn-sm btn-info"><i class="fas fa-eye"></i></button>
                                    <button class="btn btn-sm btn-danger"><i class="fas fa-trash"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td>PRD002</td>
                                <td>iPhone 15 Pro</td>
                                <td>Electrónicos</td>
                                <td>$999.99</td>
                                <td>12</td>
                                <td><span class="badge bg-warning">Stock Bajo</span></td>
                                <td>
                                    <button class="btn btn-sm btn-primary"><i class="fas fa-edit"></i></button>
                                    <button class="btn btn-sm btn-info"><i class="fas fa-eye"></i></button>
                                    <button class="btn btn-sm btn-danger"><i class="fas fa-trash"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td>PRD003</td>
                                <td>Silla Ergonómica</td>
                                <td>Muebles</td>
                                <td>$299.99</td>
                                <td>0</td>
                                <td><span class="badge bg-danger">Agotado</span></td>
                                <td>
                                    <button class="btn btn-sm btn-primary"><i class="fas fa-edit"></i></button>
                                    <button class="btn btn-sm btn-info"><i class="fas fa-eye"></i></button>
                                    <button class="btn btn-sm btn-danger"><i class="fas fa-trash"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td>PRD004</td>
                                <td>Monitor 4K Samsung</td>
                                <td>Electrónicos</td>
                                <td>$449.99</td>
                                <td>78</td>
                                <td><span class="badge bg-success">Activo</span></td>
                                <td>
                                    <button class="btn btn-sm btn-primary"><i class="fas fa-edit"></i></button>
                                    <button class="btn btn-sm btn-info"><i class="fas fa-eye"></i></button>
                                    <button class="btn btn-sm btn-danger"><i class="fas fa-trash"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td>PRD005</td>
                                <td>Teclado Mecánico</td>
                                <td>Accesorios</td>
                                <td>$129.99</td>
                                <td>156</td>
                                <td><span class="badge bg-success">Activo</span></td>
                                <td>
                                    <button class="btn btn-sm btn-primary"><i class="fas fa-edit"></i></button>
                                    <button class="btn btn-sm btn-info"><i class="fas fa-eye"></i></button>
                                    <button class="btn btn-sm btn-danger"><i class="fas fa-trash"></i></button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <nav>
                    <ul class="pagination justify-content-center">
                        <li class="page-item disabled"><a class="page-link" href="#">Anterior</a></li>
                        <li class="page-item active"><a class="page-link" href="#">1</a></li>
                        <li class="page-item"><a class="page-link" href="#">2</a></li>
                        <li class="page-item"><a class="page-link" href="#">3</a></li>
                        <li class="page-item"><a class="page-link" href="#">Siguiente</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-md-6">
        <div class="card border-info">
            <div class="card-header bg-info text-white">
                <h5><i class="fas fa-tools"></i> Herramientas de Gestión</h5>
            </div>
            <div class="card-body">
                <div class="d-grid gap-2">
                    <button class="btn btn-outline-primary">
                        <i class="fas fa-upload"></i> Importar Productos
                    </button>
                    <button class="btn btn-outline-success">
                        <i class="fas fa-download"></i> Exportar Catálogo
                    </button>
                    <button class="btn btn-outline-warning">
                        <i class="fas fa-sync"></i> Sincronizar Inventario
                    </button>
                    <button class="btn btn-outline-info">
                        <i class="fas fa-chart-bar"></i> Análisis de Ventas
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card border-warning">
            <div class="card-header bg-warning text-dark">
                <h5><i class="fas fa-exclamation-triangle"></i> Alertas de Inventario</h5>
            </div>
            <div class="card-body">
                <div class="alert alert-warning">
                    <i class="fas fa-exclamation-circle"></i>
                    <strong>23 productos</strong> tienen stock bajo
                </div>
                <div class="alert alert-danger">
                    <i class="fas fa-times-circle"></i>
                    <strong>5 productos</strong> están agotados
                </div>
                <div class="alert alert-info">
                    <i class="fas fa-info-circle"></i>
                    <strong>Recomendación:</strong> Realizar pedido de restock para productos críticos
                </div>
            </div>
        </div>
    </div>
</div>

@if (User.IsInRole("Admin"))
{
    <div class="row mt-4">
        <div class="col-md-12">
            <div class="card border-danger">
                <div class="card-header bg-danger text-white">
                    <h5><i class="fas fa-crown"></i> Funciones Administrativas</h5>
                </div>
                <div class="card-body">
                    <p>Funciones adicionales disponibles solo para administradores:</p>
                    <div class="row">
                        <div class="col-md-3">
                            <button class="btn btn-outline-danger w-100">
                                <i class="fas fa-database"></i><br>Gestión Masiva
                            </button>
                        </div>
                        <div class="col-md-3">
                            <button class="btn btn-outline-warning w-100">
                                <i class="fas fa-dollar-sign"></i><br>Ajuste de Precios
                            </button>
                        </div>
                        <div class="col-md-3">
                            <button class="btn btn-outline-info w-100">
                                <i class="fas fa-tags"></i><br>Configurar Categorías
                            </button>
                        </div>
                        <div class="col-md-3">
                            <button class="btn btn-outline-success w-100">
                                <i class="fas fa-cog"></i><br>Configuración Avanzada
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
}

<div class="alert alert-success mt-4">
    <i class="fas fa-check-circle"></i>
    <strong>Acceso Autorizado:</strong> Tienes los permisos necesarios para gestionar productos. 
    Esta funcionalidad requiere el permiso específico "products.manage".
</div>

@section Scripts {
    <script>
        // Simular interactividad
        document.querySelectorAll('.btn-primary').forEach(btn => {
            btn.addEventListener('click', function() {
                if (this.innerHTML.includes('fa-edit')) {
                    alert('Demo: Editando producto...');
                }
            });
        });
        
        document.querySelectorAll('.btn-info').forEach(btn => {
            btn.addEventListener('click', function() {
                if (this.innerHTML.includes('fa-eye')) {
                    alert('Demo: Viendo detalles del producto...');
                }
            });
        });
        
        document.querySelectorAll('.btn-danger').forEach(btn => {
            btn.addEventListener('click', function() {
                if (this.innerHTML.includes('fa-trash')) {
                    if (confirm('¿Estás seguro de que quieres eliminar este producto?')) {
                        alert('Demo: Producto eliminado');
                    }
                }
            });
        });
        
        console.log('ManageProducts cargado - Permiso: products.manage verificado');
    </script>
}