@model UserProfileResource
@{
    ViewData["Title"] = "Editar Perfil";
}

<div class="d-flex justify-content-between align-items-center mb-4">
    <h1><i class="fas fa-user-edit text-info"></i> Editar Mi Perfil</h1>
    <span class="badge bg-info fs-6">
        <i class="fas fa-user-check"></i> Autorización Basada en Recursos
    </span>
</div>

<div class="protected-section">
    <h5><i class="fas fa-shield-alt"></i> Verificación de Propiedad</h5>
    <p class="mb-0">Esta página utiliza <strong>Resource-based Authorization</strong>. Solo puedes editar tu propio perfil mediante el <code>OwnershipAuthorizationHandler</code>.</p>
</div>

<div class="row">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header bg-info text-white">
                <h5><i class="fas fa-user"></i> Información Personal</h5>
            </div>
            <div class="card-body">
                <form>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Nombre Completo</label>
                                <input type="text" class="form-control" value="@Model.DisplayName" readonly>
                                <small class="text-muted">Sincronizado desde Azure AD</small>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Email</label>
                                <input type="email" class="form-control" value="@Model.Email" readonly>
                                <small class="text-muted">Sincronizado desde Azure AD</small>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Departamento</label>
                                <input type="text" class="form-control" value="@Model.Department" readonly>
                                <small class="text-muted">Asignado por administrador</small>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">ID de Usuario</label>
                                <input type="text" class="form-control" value="@Model.OwnerId" readonly>
                                <small class="text-muted">Identificador único</small>
                            </div>
                        </div>
                    </div>

                    <hr>
                    
                    <h6><i class="fas fa-cogs"></i> Preferencias Personales</h6>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Tema de Interfaz</label>
                                <select class="form-select">
                                    <option value="light" selected>Claro</option>
                                    <option value="dark">Oscuro</option>
                                    <option value="auto">Automático</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Idioma</label>
                                <select class="form-select">
                                    <option value="es" selected>Español</option>
                                    <option value="en">English</option>
                                    <option value="fr">Français</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="notifications" checked>
                            <label class="form-check-label" for="notifications">
                                Recibir notificaciones por email
                            </label>
                        </div>
                    </div>

                    <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                        <button type="button" class="btn btn-secondary me-md-2">
                            <i class="fas fa-times"></i> Cancelar
                        </button>
                        <button type="submit" class="btn btn-info">
                            <i class="fas fa-save"></i> Guardar Cambios
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="card">
            <div class="card-header bg-secondary text-white">
                <h5><i class="fas fa-info-circle"></i> Información de Seguridad</h5>
            </div>
            <div class="card-body">
                <div class="alert alert-success">
                    <i class="fas fa-check-circle"></i>
                    <strong>Verificación OK</strong><br>
                    Eres el propietario de este perfil
                </div>
                
                <h6>Detalles de Autorización:</h6>
                <ul class="list-unstyled">
                    <li><i class="fas fa-user text-primary"></i> <strong>Owner ID:</strong> <code>@Model.OwnerId</code></li>
                    <li><i class="fas fa-building text-secondary"></i> <strong>Departamento:</strong> @Model.Department</li>
                </ul>
                
                <hr>
                
                <h6>Políticas Aplicadas:</h6>
                <span class="badge bg-info">CanEditOwnProfile</span>
                <span class="badge bg-secondary">OwnershipRequirement</span>
            </div>
        </div>
    </div>
</div>

<div class="alert alert-info mt-4">
    <i class="fas fa-lightbulb"></i>
    <strong>Implementación de Seguridad:</strong> Esta página demuestra autorización basada en recursos. 
    El sistema verifica que el usuario actual sea el propietario del perfil antes de permitir el acceso.
</div>